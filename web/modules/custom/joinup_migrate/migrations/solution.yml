id: solution
label: 'Solutions'
migration_tags:
  - solution
  - og
source:
  plugin: solution
  track_changes: true
process:
  id: uri
  label: title
  field_is_banner:
    plugin: migration
    source: nid
    migration: solution_banner
    no_stub: true

  # Contact info imported from 'project_project' is handled in ISAICP-3103.
  # Follow-up @see https://webgate.ec.europa.eu/CITnet/jira/browse/ISAICP-3103
  field_is_contact_information:
    plugin: migration
    source: contact
    migration: contact
    no_stub: true
  field_is_creation_date: created_time
  field_is_description/value: body
  field_is_description/format:
    plugin: default_value
    default_value: content_editor
  field_is_distribution:
    plugin: migration
    source: distribution
    migration: distribution
    no_stub: true
  field_is_documentation: documentation
  field_keywords: keywords
  field_is_landing_page: landing_page
  field_is_logo:
    plugin: migration
    source: nid
    migration: solution_logo
    no_stub: true
  field_is_metrics_page: metrics_page
  field_is_modification_date: changed_time
  field_is_owner:
    plugin: migration
    source: owner
    migration: owner
    no_stub: true
  field_policy_domain:
    plugin: policy_domain
    source: policy2

  # Follow-up @see https://webgate.ec.europa.eu/CITnet/jira/browse/ISAICP-3019
  # field_is_related_solutions:

  # Follow-up @see https://webgate.ec.europa.eu/CITnet/jira/browse/ISAICP-3020
  # field_is_solution_type:

  field_spatial_coverage:
    plugin: term_reference
    source: country
    vocabulary: spatial
  field_is_state:
    plugin: static_map
    source: sid
    map:
      # asset_release
      36: draft
      37: proposed
      38: needs_update
      39: validated
      40: needs_update
      41: proposed
      50: deletion_request
      52: blacklisted
      # project_project
      1: draft
      8: proposed
      9: validated
      10: needs_update
    default_value: draft

  # Follow-up @see https://webgate.ec.europa.eu/CITnet/jira/browse/ISAICP-3068
  # field_status:
  #   plugin: static_map
  #   source: status
  #   map:
  #     11646: http://purl.org/adms/status/Completed
  #     11647: http://purl.org/adms/status/Deprecated
  #     11648: http://purl.org/adms/status/UnderDevelopment
  #     11649: http://purl.org/adms/status/Withdrawn

  # Follow-up @see https://webgate.ec.europa.eu/CITnet/jira/browse/ISAICP-3019
  # field_is_translation:

destination:
  plugin: entity:rdf_entity
  default_bundle: solution
migration_dependencies:
  required:
    - solution_banner
    - solution_logo
    - distribution
    - owner
    - contact
    - documentation_file
